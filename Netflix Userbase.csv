1. Find the total number of users from each country,
,
"SELECT COUNTRY,COUNT(USER_ID) TOTAL_USERS FROM USERBASE GROUP BY COUNTRY ORDER BY TOTAL_USERS DESC",
,
Aggregate and Group by Functions,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
2.which Type of subscription users are showing interest to use,
,
Aggregate and Group by Functions,"SELECT SUBSCRIPTION_TYPE,COUNT(SUBSCRIPTION_TYPE) TOTAL_SUBSCRIPTIONS FROM userbase GROUP BY SUBSCRIPTION_TYPE;"
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
3. Find out which type subscription is more popular in every country,
,
"Using CTE,Window Functions","WITH CTE AS (SELECT SUBSCRIPTION_TYPE,Country,COUNT(SUBSCRIPTION_TYPE) TOTAL_SUBSCRIPTIONS FROM userbase GROUP BY SUBSCRIPTION_TYPE,Country ),"
,"CTE2 AS (SELECT *,ROW_NUMBER() OVER(PARTITION BY COUNTRY ORDER BY TOTAL_SUBSCRIPTIONS DESC) RN FROM CTE) SELECT COUNTRY,Subscription_Type,TOTAL_SUBSCRIPTIONS"
,FROM CTE2 WHERE RN=1 ;
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
4.what type of plan is more popular on each type of device ,
,
Using window fns and Subquery,"SELECT * FROM (SELECT DEVICE,SUBSCRIPTION_TYPE, COUNT(SUBSCRIPTION_TYPE) TOTAL,ROW_NUMBER() OVER(PARTITION BY DEVICE ORDER BY COUNT(SUBSCRIPTION_TYPE) DESC) RN "
,"FROM userbase GROUP BY DEVICE,SUBSCRIPTION_TYPE )A WHERE A.RN=1"
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
,
Without window fns and subquery,"SELECT TOP 4 DEVICE,SUBSCRIPTION_TYPE, COUNT(SUBSCRIPTION_TYPE) TOTAL FROM userbase GROUP BY DEVICE,SUBSCRIPTION_TYPE ORDER BY TOTAL DESC"
